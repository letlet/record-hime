{"version":3,"file":"index.js","sources":["../../node_modules/_@babel_runtime@7.7.4@@babel/runtime/helpers/classCallCheck.js","../../node_modules/_@babel_runtime@7.7.4@@babel/runtime/helpers/createClass.js","dev/index.js"],"sourcesContent":["function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","import './index.scss';\n\nclass Injected {\n    constructor() {\n        this.blobs = [];\n        this.src = '';\n        this.timer = null;\n        this.video = null;\n        this.stream = null;\n        this.mediaRecorder = null;\n        this.createUI();\n        this.bindEvent();\n        this.analysis();\n    }\n\n    static get options() {\n        return {\n            audioBitsPerSecond: 128000,\n            videoBitsPerSecond: 5000000,\n            mimeType: 'video/webm; codecs=\"vp8, opus\"',\n        };\n    }\n\n    get size() {\n        return this.blobs.reduce((size, item) => size + item.size, 0);\n    }\n\n    log(msg) {\n        throw new Error(`录播姬 --> ${msg}`);\n    }\n\n    durationToTime(duration) {\n        const m = String(Math.floor(duration / 60)).slice(-5);\n        const s = String(duration % 60);\n        return `${m.length === 1 ? `0${m}` : m}:${s.length === 1 ? `0${s}` : s}`;\n    }\n\n    mergeBlobs(blobs = []) {\n        const { size } = this;\n        return new Promise(resolve => {\n            const result = blobs.reduce((resultBlob, item) => {\n                const blob = new Blob([resultBlob, item], {\n                    type: 'video/webm',\n                });\n                this.$wait.textContent = `${Math.floor((blob.size / size || 0) * 100)}%`;\n                return blob;\n            }, new Blob([]));\n            resolve(result);\n        });\n    }\n\n    createUI() {\n        this.$container = document.createElement('div');\n        this.$container.classList.add('record-hime');\n        this.$container.innerHTML = `\n            <div class=\"rh-states\">\n                <div class=\"rh-state rh-state-before-record rh-active\">开始</div>\n                <div class=\"rh-state rh-state-recording\">停止</div>\n                <div class=\"rh-state rh-state-after-record\">下载</div>\n                <div class=\"rh-state rh-state-wait\">0%</div>\n            </div>\n            <div class=\"rh-monitors\">\n                <div class=\"rh-monitor rh-monitor-top\">\n                    <div class=\"rh-monitor-name\">时长：</div>\n                    <div class=\"rh-monitor-value rh-duration\">00:00</div>\n                </div>\n                <div class=\"rh-monitor rh-monitor-bottom\">\n                    <div class=\"rh-monitor-name\">大小：</div>\n                    <div class=\"rh-monitor-value rh-size\">0.00M</div>\n                </div>\n            </div>\n        `;\n\n        this.$states = Array.from(this.$container.querySelectorAll('.rh-state'));\n        this.$beforeRecord = this.$container.querySelector('.rh-state-before-record');\n        this.$recording = this.$container.querySelector('.rh-state-recording');\n        this.$afterRecord = this.$container.querySelector('.rh-state-after-record');\n        this.$wait = this.$container.querySelector('.rh-state-wait');\n        this.$duration = this.$container.querySelector('.rh-duration');\n        this.$size = this.$container.querySelector('.rh-size');\n        this.$monitor = this.$container.querySelector('.rh-monitor');\n        this.$container.classList.add('rh-focus');\n        document.body.appendChild(this.$container);\n\n        setTimeout(() => {\n            this.$container.classList.remove('rh-focus');\n        }, 10000);\n    }\n\n    bindEvent() {\n        this.$beforeRecord.addEventListener('click', () => {\n            this.start();\n        });\n\n        this.$recording.addEventListener('click', () => {\n            this.stop();\n        });\n\n        this.$afterRecord.addEventListener('click', () => {\n            this.download().then(() => {\n                this.reset();\n            });\n        });\n\n        let isDroging = false;\n        let lastPageX = 0;\n        let lastPageY = 0;\n        let lastPlayerLeft = 0;\n        let lastPlayerTop = 0;\n\n        this.$monitor.addEventListener('mousedown', event => {\n            isDroging = true;\n            lastPageX = event.pageX;\n            lastPageY = event.pageY;\n            lastPlayerLeft = this.$container.offsetLeft;\n            lastPlayerTop = this.$container.offsetTop;\n        });\n\n        document.addEventListener('mousemove', event => {\n            if (isDroging) {\n                const x = event.pageX - lastPageX;\n                const y = event.pageY - lastPageY;\n                this.$container.style.transform = `translate(${x}px, ${y}px)`;\n            }\n        });\n\n        document.addEventListener('mouseup', event => {\n            if (isDroging) {\n                isDroging = false;\n                this.$container.style.transform = 'translate(0, 0)';\n                const x = lastPlayerLeft + event.pageX - lastPageX;\n                const y = lastPlayerTop + event.pageY - lastPageY;\n                this.$container.style.left = `${x}px`;\n                this.$container.style.top = `${y}px`;\n            }\n        });\n    }\n\n    start() {\n        const videos = Array.from(document.querySelectorAll('video'));\n        if (videos.length) {\n            this.video = videos.find(item => item.captureStream);\n            if (this.video) {\n                this.src = this.video.src;\n                this.changeState('recording');\n                this.stream = this.video.captureStream();\n                if (MediaRecorder && MediaRecorder.isTypeSupported(Injected.options.mimeType)) {\n                    this.mediaRecorder = new MediaRecorder(this.stream, Injected.options);\n                    this.mediaRecorder.ondataavailable = event => {\n                        this.blobs.push(event.data);\n                        const size = this.size / 1024 / 1024;\n                        this.$size.textContent = `${size.toFixed(2).slice(-8)}M`;\n                        this.$duration.textContent = this.durationToTime(\n                            this.blobs.filter(item => item.size > 1024).length,\n                        );\n                    };\n                    this.mediaRecorder.start(1000);\n                    this.timer = setInterval(() => {\n                        if (this.src !== this.video.src) {\n                            this.stop();\n                        }\n                    }, 1000);\n                } else {\n                    this.log(`不支持录制格式：${Injected.options.mimeType}`);\n                }\n            } else {\n                this.log('未发现视频流');\n            }\n        } else {\n            this.log('未发现视频元素');\n        }\n    }\n\n    stop() {\n        this.changeState('after-record');\n        this.mediaRecorder.stop();\n        clearInterval(this.timer);\n    }\n\n    download() {\n        this.changeState('wait');\n        return this.mergeBlobs(this.blobs).then(blob => {\n            const link = document.createElement('a');\n            link.href = URL.createObjectURL(blob);\n            link.download = `${document.title || Date.now()}.webm`;\n            link.style.display = 'none';\n            document.body.appendChild(link);\n            link.click();\n            document.body.removeChild(link);\n        });\n    }\n\n    reset() {\n        this.changeState('before-record');\n        this.blobs = [];\n        this.src = '';\n        this.timer = null;\n        this.video = null;\n        this.stream = null;\n        this.mediaRecorder = null;\n        this.$duration.textContent = '00:00';\n        this.$size.textContent = '0.00M';\n        this.$wait.textContent = '0%';\n    }\n\n    changeState(state) {\n        this.$states.forEach(item => {\n            if (item.classList.contains(`rh-state-${state}`)) {\n                item.classList.add('rh-active');\n            } else {\n                item.classList.remove('rh-active');\n            }\n        });\n    }\n\n    analysis() {\n        // eslint-disable-next-line no-underscore-dangle\n        window._hmt = window._hmt || [];\n        const hm = document.createElement('script');\n        hm.src = 'https://hm.baidu.com/hm.js?3c93ca28120f48d2a27889d0623cd7b7';\n        const s = document.getElementsByTagName('script')[0];\n        s.parentNode.insertBefore(hm, s);\n    }\n}\n\nexport default new Injected();\n"],"names":["Injected","blobs","src","timer","video","stream","mediaRecorder","createUI","bindEvent","analysis","msg","Error","duration","m","String","Math","floor","slice","s","length","size","Promise","resolve","result","reduce","resultBlob","item","blob","Blob","type","$wait","textContent","$container","document","createElement","classList","add","innerHTML","$states","Array","from","querySelectorAll","$beforeRecord","querySelector","$recording","$afterRecord","$duration","$size","$monitor","body","appendChild","setTimeout","remove","addEventListener","start","stop","download","then","reset","isDroging","lastPageX","lastPageY","lastPlayerLeft","lastPlayerTop","event","pageX","pageY","offsetLeft","offsetTop","x","y","style","transform","left","top","videos","find","captureStream","changeState","MediaRecorder","isTypeSupported","options","mimeType","ondataavailable","push","data","toFixed","durationToTime","filter","setInterval","log","clearInterval","mergeBlobs","link","href","URL","createObjectURL","title","Date","now","display","click","removeChild","state","forEach","contains","window","_hmt","hm","getElementsByTagName","parentNode","insertBefore","audioBitsPerSecond","videoBitsPerSecond"],"mappings":"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"}
{"version":3,"file":"index.js","sources":["../../node_modules/_@babel_runtime@7.7.4@@babel/runtime/helpers/classCallCheck.js","../../node_modules/_@babel_runtime@7.7.4@@babel/runtime/helpers/createClass.js","dev/index.js"],"sourcesContent":["function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","import './index.scss';\n\nclass Injected {\n    constructor() {\n        this.blobs = [];\n        this.src = '';\n        this.timer = null;\n        this.video = null;\n        this.stream = null;\n        this.mediaRecorder = null;\n        this.createUI();\n        this.bindEvent();\n        this.analysis();\n    }\n\n    static get options() {\n        return {\n            audioBitsPerSecond: 128000,\n            videoBitsPerSecond: 5000000,\n            mimeType: 'video/webm; codecs=\"vp8, opus\"',\n        };\n    }\n\n    get size() {\n        return this.blobs.reduce((size, item) => size + item.size, 0);\n    }\n\n    log(msg) {\n        throw new Error(`录播姬 --> ${msg}`);\n    }\n\n    durationToTime(duration) {\n        const m = String(Math.floor(duration / 60)).slice(-5);\n        const s = String(duration % 60);\n        return `${m.length === 1 ? `0${m}` : m}:${s.length === 1 ? `0${s}` : s}`;\n    }\n\n    mergeBlobs(blobs = []) {\n        const { size } = this;\n        let result = new Blob([]);\n\n        const tasks = blobs.map(blob => () => {\n            return new Promise(resolve => {\n                setTimeout(() => {\n                    result = new Blob([result, blob]);\n                    this.$wait.textContent = `${Math.floor((result.size / size || 0) * 100)}%`;\n                    resolve();\n                }, 0);\n            });\n        });\n\n        return new Promise(resolve => {\n            (function loop() {\n                const task = tasks.shift();\n                if (task) {\n                    task().then(loop);\n                } else {\n                    resolve(result);\n                }\n            })();\n        });\n    }\n\n    createUI() {\n        this.$container = document.createElement('div');\n        this.$container.classList.add('record-hime');\n        this.$container.innerHTML = `\n            <div class=\"rh-states\">\n                <div class=\"rh-state rh-state-before-record rh-active\">开始</div>\n                <div class=\"rh-state rh-state-recording\">停止</div>\n                <div class=\"rh-state rh-state-after-record\">下载</div>\n                <div class=\"rh-state rh-state-wait\">0%</div>\n            </div>\n            <div class=\"rh-monitors\">\n                <div class=\"rh-monitor rh-monitor-top\">\n                    <div class=\"rh-monitor-name\">时长：</div>\n                    <div class=\"rh-monitor-value rh-duration\">00:00</div>\n                </div>\n                <div class=\"rh-monitor rh-monitor-bottom\">\n                    <div class=\"rh-monitor-name\">大小：</div>\n                    <div class=\"rh-monitor-value rh-size\">0.00M</div>\n                </div>\n            </div>\n        `;\n\n        this.$states = Array.from(this.$container.querySelectorAll('.rh-state'));\n        this.$beforeRecord = this.$container.querySelector('.rh-state-before-record');\n        this.$recording = this.$container.querySelector('.rh-state-recording');\n        this.$afterRecord = this.$container.querySelector('.rh-state-after-record');\n        this.$wait = this.$container.querySelector('.rh-state-wait');\n        this.$duration = this.$container.querySelector('.rh-duration');\n        this.$size = this.$container.querySelector('.rh-size');\n        this.$monitor = this.$container.querySelector('.rh-monitor');\n        this.$container.classList.add('rh-focus');\n        document.body.appendChild(this.$container);\n\n        setTimeout(() => {\n            this.$container.classList.remove('rh-focus');\n        }, 10000);\n    }\n\n    bindEvent() {\n        this.$beforeRecord.addEventListener('click', () => {\n            this.start();\n        });\n\n        this.$recording.addEventListener('click', () => {\n            this.stop();\n        });\n\n        this.$afterRecord.addEventListener('click', () => {\n            if (this.blobs.length) {\n                this.download().then(() => {\n                    this.reset();\n                });\n            } else {\n                this.reset();\n            }\n        });\n\n        let isDroging = false;\n        let lastPageX = 0;\n        let lastPageY = 0;\n        let lastPlayerLeft = 0;\n        let lastPlayerTop = 0;\n\n        this.$monitor.addEventListener('mousedown', event => {\n            isDroging = true;\n            lastPageX = event.pageX;\n            lastPageY = event.pageY;\n            lastPlayerLeft = this.$container.offsetLeft;\n            lastPlayerTop = this.$container.offsetTop;\n        });\n\n        document.addEventListener('mousemove', event => {\n            if (isDroging) {\n                const x = event.pageX - lastPageX;\n                const y = event.pageY - lastPageY;\n                this.$container.style.transform = `translate(${x}px, ${y}px)`;\n            }\n        });\n\n        document.addEventListener('mouseup', event => {\n            if (isDroging) {\n                isDroging = false;\n                this.$container.style.transform = 'translate(0, 0)';\n                const x = lastPlayerLeft + event.pageX - lastPageX;\n                const y = lastPlayerTop + event.pageY - lastPageY;\n                this.$container.style.left = `${x}px`;\n                this.$container.style.top = `${y}px`;\n            }\n        });\n    }\n\n    start() {\n        const videos = Array.from(document.querySelectorAll('video'));\n        if (videos.length) {\n            this.video = videos.find(item => item.captureStream);\n            if (this.video) {\n                try {\n                    this.src = this.video.src;\n                    this.video.crossOrigin = 'anonymous';\n                    this.stream = this.video.captureStream();\n                    this.changeState('recording');\n                    if (MediaRecorder && MediaRecorder.isTypeSupported(Injected.options.mimeType)) {\n                        this.mediaRecorder = new MediaRecorder(this.stream, Injected.options);\n                        this.mediaRecorder.ondataavailable = event => {\n                            this.blobs.push(event.data);\n                            const size = this.size / 1024 / 1024;\n                            this.$size.textContent = `${size.toFixed(2).slice(-8)}M`;\n                            this.$duration.textContent = this.durationToTime(\n                                this.blobs.filter(item => item.size > 1024).length,\n                            );\n                        };\n                        this.mediaRecorder.start(1000);\n                        this.timer = setInterval(() => {\n                            if (this.src !== this.video.src) {\n                                this.stop();\n                            }\n                        }, 1000);\n                    } else {\n                        this.log(`不支持录制格式：${Injected.options.mimeType}`);\n                    }\n                } catch (error) {\n                    this.log(`录制视频流失败：${error.message.trim()}`);\n                }\n            } else {\n                this.log('未发现视频流');\n            }\n        } else {\n            this.log('未发现视频元素');\n        }\n    }\n\n    stop() {\n        clearInterval(this.timer);\n        this.changeState('after-record');\n        if (this.mediaRecorder) {\n            this.mediaRecorder.stop();\n        }\n    }\n\n    download() {\n        this.changeState('wait');\n        return this.mergeBlobs(this.blobs).then(blob => {\n            const link = document.createElement('a');\n            link.href = URL.createObjectURL(blob);\n            link.download = `${document.title || Date.now()}.webm`;\n            link.style.display = 'none';\n            document.body.appendChild(link);\n            link.click();\n            document.body.removeChild(link);\n        });\n    }\n\n    reset() {\n        clearInterval(this.timer);\n        this.changeState('before-record');\n        this.blobs = [];\n        this.src = '';\n        this.timer = null;\n        this.video = null;\n        this.stream = null;\n        this.mediaRecorder = null;\n        this.$duration.textContent = '00:00';\n        this.$size.textContent = '0.00M';\n        this.$wait.textContent = '0%';\n    }\n\n    changeState(state) {\n        this.$states.forEach(item => {\n            if (item.classList.contains(`rh-state-${state}`)) {\n                item.classList.add('rh-active');\n            } else {\n                item.classList.remove('rh-active');\n            }\n        });\n    }\n\n    analysis() {\n        // eslint-disable-next-line no-underscore-dangle\n        window._hmt = window._hmt || [];\n        const hm = document.createElement('script');\n        hm.src = 'https://hm.baidu.com/hm.js?3c93ca28120f48d2a27889d0623cd7b7';\n        const s = document.getElementsByTagName('script')[0];\n        s.parentNode.insertBefore(hm, s);\n    }\n}\n\nexport default new Injected();\n"],"names":["Injected","blobs","src","timer","video","stream","mediaRecorder","createUI","bindEvent","analysis","msg","Error","duration","m","String","Math","floor","slice","s","length","size","result","Blob","tasks","map","blob","Promise","resolve","setTimeout","$wait","textContent","loop","task","shift","then","$container","document","createElement","classList","add","innerHTML","$states","Array","from","querySelectorAll","$beforeRecord","querySelector","$recording","$afterRecord","$duration","$size","$monitor","body","appendChild","remove","addEventListener","start","stop","download","reset","isDroging","lastPageX","lastPageY","lastPlayerLeft","lastPlayerTop","event","pageX","pageY","offsetLeft","offsetTop","x","y","style","transform","left","top","videos","find","item","captureStream","crossOrigin","changeState","MediaRecorder","isTypeSupported","options","mimeType","ondataavailable","push","data","toFixed","durationToTime","filter","setInterval","log","error","message","trim","clearInterval","mergeBlobs","link","href","URL","createObjectURL","title","Date","now","display","click","removeChild","state","forEach","contains","window","_hmt","hm","getElementsByTagName","parentNode","insertBefore","reduce","audioBitsPerSecond","videoBitsPerSecond"],"mappings":"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"}